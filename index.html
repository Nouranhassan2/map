<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title> Neighborhood Map</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSQwC16g8ZKoyVC2EpixPr0e-7IcPII14&libraries=places&callback=initMap" async defer></script>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      padding: 0;
    }

    #map {
      height: 100vh;
      width: 100%;
    }

    #sidebar {
      height: 100%;
      width: 300px;
      position: fixed;
      right: 0;
      top: 0;
      background-color: rgba(255, 255, 255, 0.9);
      box-shadow: -2px 0 5px rgba(0, 0, 0, 0.2);
      padding: 20px;
      display: none;
      z-index: 1000;
      overflow-y: auto;
    }

    #sidebar h3 {
      font-size: 24px;
      margin-top: 0;
    }

    #sidebar p {
      margin: 0;
      font-size: 16px;
    }

    #close-sidebar {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #d9534f;
      color: white;
      border: none;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 5px;
    }

    #search-input {
      position: absolute;
      top: 20px;
      left: 20px;
      width: 300px;
      padding: 10px;
      font-size: 16px;
      z-index: 1000;
    }

    .whatsapp-share-btn {
      display: inline-block;
      background-color: #25D366;
      color: white;
      padding: 10px;
      font-size: 16px;
      text-decoration: none;
      border-radius: 5px;
      margin-top: 20px;
    }

    .whatsapp-share-btn:hover {
      background-color: #20b858;
    }

    #location-image {
      width: 100%;
      height: auto;
      border-radius: 5px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <input id="search-input" type="text" placeholder="Search locations...">
  <div id="map"></div>

  <div id="sidebar">
    <button id="close-sidebar">X</button>
    <h3 id="location-name"></h3>
    <p><strong>Location:</strong> <span id="location-details"></span></p>
    <a id="location-link" href="#" target="_blank">Visit website</a>
    <img id="location-image" src="" alt="Location image">
    <a id="share-btn-sidebar" href="#" target="_blank" class="whatsapp-share-btn">Share on WhatsApp</a>
  </div>

  <script>
    let map, searchBox;
    let markers = [];
    
    const locations = [
      { lat: 21.2854, lng: 39.2376, name: 'حي السنابل - جدة', link: 'https://jed1.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', image: 'https://jed1.matajeralhai.com/Images/Photos/63f719b49e404dbb9a7217ded02fef23.webp' },
            { lat: 21.2854, lng: 39.2376, name: 'حي الأجاويد - جدة', link: 'https://jed1.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', image: 'url_to_image2' },
            { lat: 21.5433, lng: 39.1728, name: 'حي الرياض - جدة', link: 'https://jed6.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', image: 'url_to_image3' },
            { lat: 21.5433, lng: 39.1728, name: 'حي طيبة - جدة', link: 'https://jed6.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', image: 'url_to_image4' },
            { lat: 21.6682, lng: 39.1091, name: 'حي أبحر - جدة', link: 'https://jed6.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', image: 'url_to_image5' },
            { lat: 21.5454, lng: 39.2049, name: 'حي الحمدانية - جدة', link: 'https://jed4.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/orange-dot.png', image: 'url_to_image6' },
            { lat: 21.5027, lng: 39.2433, name: 'حي الفضيلة - جدة', link: 'https://jed5.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image7' },
            { lat: 21.4354, lng: 39.3705, name: 'حي القرينية - جدة', link: 'https://jed5.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image8' },
            { lat: 21.5752, lng: 39.2125, name: 'حي السامر - جدة', link: 'https://jed2.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image9' },
            { lat: 25.7605, lng: 45.3943, name: 'حي تمير - الرياض', link: 'https://rydh5.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image10' },
            { lat: 21.6319, lng: 39.1225, name: 'حي النعيم - جدة', link: 'https://jed10.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image11' },
            { lat: 21.6159, lng: 39.1277, name: 'حي المحمدية - جدة', link: 'https://jed10.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image12' },
            { lat: 21.6261, lng: 39.1425, name: 'حي المرجان - جدة', link: 'https://jed10.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image13' },
            { lat: 21.6195, lng: 39.1480, name: 'حي البساتين - جدة', link: 'https://jed10.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image14' },
            { lat: 24.7402, lng: 46.6520, name: 'حي الغدير - الرياض', link: 'https://rydh1.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image15' },
            { lat: 24.7889, lng: 46.7223, name: 'حي الفلاح - الرياض', link: 'https://rydh2.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image16' },
            { lat: 24.7688, lng: 46.7111, name: 'حي الوادي - الرياض', link: 'https://rydh3.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image17' },
            { lat: 24.7725, lng: 46.7087, name: 'حي النفل - الرياض', link: 'https://rydh4.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image18' },
            { lat: 21.5892, lng: 39.1979, name: 'حي الصفا - جدة', link: 'https://jed3.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image19' },
            { lat: 21.3891, lng: 39.8579, name: 'حي الزايدي - مكة', link: 'https://mak2.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image20' },
            { lat: 21.4243, lng: 39.8259, name: 'حي التنعيم - مكة', link: 'https://mak1.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image21' },
            { lat: 21.4878, lng: 39.1843, name: 'حي باب مكة - جدة', link: 'https://jed8.matajeralhai.com/', icon: 'https://maps.google.com/mapfiles/ms/icons/blue-dot.png', image: 'url_to_image22' }
      ];

    function initMap() {
      const mapCenter = { lat: 21.5600, lng: 39.1700 };

      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 9, // Closer zoom for more detail
        center: mapCenter,
        mapTypeId: 'satellite', // Satellite view for realism
        fullscreenControl: true, // Fullscreen control for better immersion
        zoomControl: true, // Zoom control
        streetViewControl: false // Disabling street view for cleaner UI
      });

      locations.forEach(location => {
        const marker = new google.maps.Marker({
          position: { lat: location.lat, lng: location.lng },
          map: map,
          icon: location.icon // Using default Google Maps pin icons
        });

        marker.addListener('click', () => {
          showSidebar(location);
        });

        markers.push(marker);
      });

      const input = document.getElementById("search-input");
      const searchBox = new google.maps.places.SearchBox(input);

      map.addListener('bounds_changed', () => {
        searchBox.setBounds(map.getBounds());
      });

      searchBox.addListener("places_changed", () => {
        const places = searchBox.getPlaces();

        if (places.length === 0) return;

        markers.forEach(marker => marker.setMap(null));

        const bounds = new google.maps.LatLngBounds();
        places.forEach(place => {
          if (!place.geometry || !place.geometry.location) return;

          const marker = new google.maps.Marker({
            map: map,
            title: place.name,
            position: place.geometry.location
          });

          markers.push(marker);

          bounds.union(place.geometry.viewport || place.geometry.location);

          marker.addListener('click', () => {
            showSidebar({
              lat: place.geometry.location.lat(),
              lng: place.geometry.location.lng(),
              name: place.name,
              link: '', // No link from Google Places
              image: 'https://via.placeholder.com/300' // Placeholder image for search results
            });
          });
        });

        map.fitBounds(bounds);
      });
    }

    function showSidebar(location) {
      document.getElementById('location-name').textContent = location.name;
      document.getElementById('location-details').textContent = `${location.lat}, ${location.lng}`;
      document.getElementById('location-link').href = location.link || '#';
      document.getElementById('location-image').src = location.image || 'https://via.placeholder.com/300';

      const shareMessage = `Check out this location: ${location.name} - Coordinates: ${location.lat}, ${location.lng}`;
      const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(shareMessage)}`;
      document.getElementById('share-btn-sidebar').href = whatsappUrl;

      document.getElementById('sidebar').style.display = 'block';
      document.getElementById('map').style.width = 'calc(100% - 300px)';
      google.maps.event.trigger(map, 'resize');
    }

    document.getElementById('close-sidebar').addEventListener('click', function() {
      document.getElementById('sidebar').style.display = 'none';
      document.getElementById('map').style.width = '100%';
      google.maps.event.trigger(map, 'resize');
    });
  </script>
</body>
</html>
